(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{23:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(8),s=a.n(c),n=a(7),o=(a(23),a(2)),l=a(3);var i=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Welcome to Marketing Copilot Manager"}),Object(l.jsx)("p",{children:"This is the welcome page."})]})},j=a(5),d=a.n(j);const b=d.a.create({baseURL:"https://mysterious-beach-84770-b25cca31cb4f.herokuapp.com/api"});console.log("API baseURL:",b.defaults.baseURL);var u=b;var h=()=>{const[e,t]=Object(r.useState)(""),[a,c]=Object(r.useState)(""),s=Object(o.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Login"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await d.a.post("".concat(u,"/login"),{email:e,password:a}),{token:r}=t.data;localStorage.setItem("token",r);const c=JSON.parse(atob(r.split(".")[1]));console.log("Decoded token:",c),"admin"===c.role?s("/admin/".concat(c.name,"/dashboard")):s("/user/".concat(c.name,"/dashboard"))}catch(r){console.error("Error during login:",r)}},children:[Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value)}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>c(e.target.value)}),Object(l.jsx)("button",{type:"submit",children:"Login"})]})]})},O=a(6);var g=()=>{const[e,t]=Object(r.useState)({name:"",email:"",password:"",role:"user"}),a=Object(o.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Register"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),console.log("Registration attempt with data:",e);try{const t=await u.post("/register",e);console.log("Registration successful:",t.data),alert("User registered successfully"),a("/login")}catch(r){console.error("Registration error:",r),alert("Registration failed")}},children:[Object(l.jsx)("input",{type:"text",placeholder:"Name",value:e.name,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{name:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e.email,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{email:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:e.password,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{password:a.target.value})),required:!0}),Object(l.jsxs)("select",{value:e.role,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{role:a.target.value})),required:!0,children:[Object(l.jsx)("option",{value:"user",children:"User"}),Object(l.jsx)("option",{value:"admin",children:"Admin"})]}),Object(l.jsx)("button",{type:"submit",children:"Register"})]})]})};var p=()=>{const{username:e}=Object(o.t)(),[t,a]=Object(r.useState)(null);return Object(r.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),t=await d.a.get("".concat(u,"/user-dashboard"),{headers:{Authorization:"Bearer ".concat(e)}});a(t.data)}catch(e){console.error("Error fetching dashboard data:",e)}})()}),[e]),t?Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"User Dashboard"}),Object(l.jsx)("pre",{children:JSON.stringify(t,null,2)})]}):Object(l.jsx)("div",{children:"Loading..."})};var x=()=>{const{username:e}=Object(o.t)(),[t,a]=Object(r.useState)(null);return Object(r.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),t=await d.a.get("".concat(u,"/admin-dashboard"),{headers:{Authorization:"Bearer ".concat(e)}});a(t.data)}catch(e){console.error("Error fetching dashboard data:",e)}})()}),[e]),t?Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Admin Dashboard"}),Object(l.jsx)("pre",{children:JSON.stringify(t,null,2)})]}):Object(l.jsx)("div",{children:"Loading..."})};var m=()=>Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"404 - Page Not Found"}),Object(l.jsx)("p",{children:"The page you are looking for does not exist."})]});var v=e=>{let{allowedRoles:t,user:a}=e;return a?t.includes(a.role)?Object(l.jsx)(o.b,{}):Object(l.jsx)(o.a,{to:"/unauthorized"}):Object(l.jsx)(o.a,{to:"/login"})};var f=function(){const[e,t]=Object(r.useState)(null);return Object(r.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(e){const a=await d.a.get("/api/user",{headers:{Authorization:"Bearer ".concat(e)}});t(a.data)}}catch(e){console.error("Error fetching user data:",e)}})()}),[]),Object(l.jsxs)(o.e,{children:[Object(l.jsx)(o.c,{path:"/",element:Object(l.jsx)(i,{})}),Object(l.jsx)(o.c,{path:"/login",element:Object(l.jsx)(h,{})}),Object(l.jsx)(o.c,{path:"/register",element:Object(l.jsx)(g,{})}),Object(l.jsx)(o.c,{path:"/user/:username/dashboard",element:Object(l.jsx)(v,{allowedRoles:["user","admin"],user:e,children:Object(l.jsx)(p,{})})}),Object(l.jsx)(o.c,{path:"/admin/:username/dashboard",element:Object(l.jsx)(v,{allowedRoles:["admin"],user:e,children:Object(l.jsx)(x,{})})}),Object(l.jsx)(o.c,{path:"*",element:Object(l.jsx)(m,{})})]})};var y=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,45)).then((t=>{let{getCLS:a,getFID:r,getFCP:c,getLCP:s,getTTFB:n}=t;a(e),r(e),c(e),s(e),n(e)}))};s.a.render(Object(l.jsx)(n.a,{children:Object(l.jsx)(f,{})}),document.getElementById("root")),y()}},[[44,1,2]]]);
//# sourceMappingURL=main.57a90255.chunk.js.map