(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{23:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var o=a(0),r=a(7),s=a.n(r),c=a(6),n=(a(23),a(2)),l=a(3);var i=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Welcome to Marketing Copilot Manager"}),Object(l.jsx)("p",{children:"This is the welcome page."})]})},j=a(8),d=a.n(j);const b=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000/api",u=d.a.create({baseURL:b});console.log("API baseURL:",u.defaults.baseURL);var O=u;var h=function(){const[e,t]=Object(o.useState)(""),[a,r]=Object(o.useState)(""),s=Object(n.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Login"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),console.log("Login attempt with email:",e);try{const t=await O.post("/login",{email:e,password:a});if(console.log("API response:",t),t.data&&t.data.token){localStorage.setItem("token",t.data.token);const e=JSON.parse(atob(t.data.token.split(".")[1]));console.log("Decoded token:",e);const a=e.name.replace(/\s+/g,"-").toLowerCase();"admin"===e.role?s("/".concat(a,"/admin-dashboard")):s("/".concat(a,"/user-dashboard"))}else console.error("Invalid API response:",t),alert("Login failed: Invalid response from server")}catch(o){console.error("Login error:",o),alert("Login failed")}},children:[Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value),required:!0}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>r(e.target.value),required:!0}),Object(l.jsx)("button",{type:"submit",children:"Login"})]})]})},m=a(5);var p=()=>{const[e,t]=Object(o.useState)({name:"",email:"",password:"",role:"user"}),a=Object(n.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Register"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),console.log("Registration attempt with data:",e);try{const t=await O.post("/register",e);console.log("Registration successful:",t.data),alert("User registered successfully"),a("/login")}catch(o){console.error("Registration error:",o),alert("Registration failed")}},children:[Object(l.jsx)("input",{type:"text",placeholder:"Name",value:e.name,onChange:a=>t(Object(m.a)(Object(m.a)({},e),{},{name:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e.email,onChange:a=>t(Object(m.a)(Object(m.a)({},e),{},{email:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:e.password,onChange:a=>t(Object(m.a)(Object(m.a)({},e),{},{password:a.target.value})),required:!0}),Object(l.jsxs)("select",{value:e.role,onChange:a=>t(Object(m.a)(Object(m.a)({},e),{},{role:a.target.value})),required:!0,children:[Object(l.jsx)("option",{value:"user",children:"User"}),Object(l.jsx)("option",{value:"admin",children:"Admin"})]}),Object(l.jsx)("button",{type:"submit",children:"Register"})]})]})};var g=()=>{const[e,t]=Object(o.useState)({}),a=Object(n.r)();Object(o.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const a=JSON.parse(atob(e.split(".")[1]));t({name:a.name,email:a.email,role:a.role})}}),[]);return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"User Dashboard"}),Object(l.jsxs)("p",{children:["Welcome to your dashboard, ",e.name,"!"]}),Object(l.jsxs)("p",{children:["Email: ",e.email]}),Object(l.jsxs)("p",{children:["Role: ",e.role]}),Object(l.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),a("/login")},children:"Logout"})]})};var x=()=>{const[e,t]=Object(o.useState)({}),a=Object(n.r)();Object(o.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const a=JSON.parse(atob(e.split(".")[1]));t({name:a.name,email:a.email,role:a.role})}}),[]);return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Admin Dashboard"}),Object(l.jsxs)("p",{children:["Welcome to your dashboard, ",e.name,"!"]}),Object(l.jsxs)("p",{children:["Email: ",e.email]}),Object(l.jsxs)("p",{children:["Role: ",e.role]}),Object(l.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),a("/login")},children:"Logout"})]})};var v=e=>{let{allowedRoles:t,user:a}=e;return a?t.includes(a.role)?Object(l.jsx)(n.b,{}):Object(l.jsx)(n.a,{to:"/unauthorized"}):Object(l.jsx)(n.a,{to:"/login"})};var f=function(){const[e,t]=Object(o.useState)(null);return Object(o.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(e){const a=await d.a.get("/api/user",{headers:{Authorization:e}});t(a.data)}}catch(e){console.error("Error fetching user data:",e)}})()}),[]),Object(l.jsxs)(n.e,{children:[Object(l.jsx)(n.c,{path:"/",element:Object(l.jsx)(i,{})}),Object(l.jsx)(n.c,{path:"/login",element:Object(l.jsx)(h,{})}),Object(l.jsx)(n.c,{path:"/register",element:Object(l.jsx)(p,{})}),Object(l.jsx)(n.c,{path:"/user-dashboard",element:Object(l.jsx)(v,{allowedRoles:["user","admin"],user:e,children:Object(l.jsx)(g,{})})}),Object(l.jsx)(n.c,{path:"/admin-dashboard",element:Object(l.jsx)(v,{allowedRoles:["admin"],user:e,children:Object(l.jsx)(x,{})})})]})};var S=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,45)).then((t=>{let{getCLS:a,getFID:o,getFCP:r,getLCP:s,getTTFB:c}=t;a(e),o(e),r(e),s(e),c(e)}))};s.a.render(Object(l.jsx)(c.a,{children:Object(l.jsx)(f,{})}),document.getElementById("root")),S()}},[[44,1,2]]]);
//# sourceMappingURL=main.84cdac23.chunk.js.map