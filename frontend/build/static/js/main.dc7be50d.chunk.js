(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{23:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var r=a(0),o=a(7),s=a.n(o),c=a(6),n=(a(23),a(2)),l=a(3);var i=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Welcome to Marketing Copilot Manager"}),Object(l.jsx)("p",{children:"This is the welcome page."})]})},j=a(8),d=a.n(j);const b=d.a.create({baseURL:"https://mysterious-beach-84770-b25cca31cb4f.herokuapp.com/api"});console.log("API baseURL:",b.defaults.baseURL);var u=b;var h=function(){const[e,t]=Object(r.useState)(""),[a,o]=Object(r.useState)(""),s=Object(n.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Login"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),console.log("Login attempt with email:",e);try{const t=await u.post("/login",{email:e,password:a});if(console.log("API response:",t),t.data&&t.data.token){localStorage.setItem("token",t.data.token);const e=JSON.parse(atob(t.data.token.split(".")[1]));console.log("Decoded token:",e);const a=e.name.replace(/\s+/g,"-").toLowerCase();"admin"===e.role?s("/".concat(a,"/admin-dashboard")):s("/".concat(a,"/user-dashboard"))}else console.error("Invalid API response:",t),alert("Login failed: Invalid response from server")}catch(r){console.error("Login error:",r),alert("Login failed")}},children:[Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value),required:!0}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>o(e.target.value),required:!0}),Object(l.jsx)("button",{type:"submit",children:"Login"})]})]})},O=a(5);var m=()=>{const[e,t]=Object(r.useState)({name:"",email:"",password:"",role:"user"}),a=Object(n.r)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Register"}),Object(l.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),console.log("Registration attempt with data:",e);try{const t=await u.post("/register",e);console.log("Registration successful:",t.data),alert("User registered successfully"),a("/login")}catch(r){console.error("Registration error:",r),alert("Registration failed")}},children:[Object(l.jsx)("input",{type:"text",placeholder:"Name",value:e.name,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{name:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"email",placeholder:"Email",value:e.email,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{email:a.target.value})),required:!0}),Object(l.jsx)("input",{type:"password",placeholder:"Password",value:e.password,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{password:a.target.value})),required:!0}),Object(l.jsxs)("select",{value:e.role,onChange:a=>t(Object(O.a)(Object(O.a)({},e),{},{role:a.target.value})),required:!0,children:[Object(l.jsx)("option",{value:"user",children:"User"}),Object(l.jsx)("option",{value:"admin",children:"Admin"})]}),Object(l.jsx)("button",{type:"submit",children:"Register"})]})]})};var p=()=>{const[e,t]=Object(r.useState)({}),a=Object(n.r)();Object(r.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const a=JSON.parse(atob(e.split(".")[1]));t({name:a.name,email:a.email,role:a.role})}}),[]);return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"User Dashboard"}),Object(l.jsxs)("p",{children:["Welcome to your dashboard, ",e.name,"!"]}),Object(l.jsxs)("p",{children:["Email: ",e.email]}),Object(l.jsxs)("p",{children:["Role: ",e.role]}),Object(l.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),a("/login")},children:"Logout"})]})};var g=()=>{const[e,t]=Object(r.useState)({}),a=Object(n.r)();Object(r.useEffect)((()=>{const e=localStorage.getItem("token");if(e){const a=JSON.parse(atob(e.split(".")[1]));t({name:a.name,email:a.email,role:a.role})}}),[]);return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Admin Dashboard"}),Object(l.jsxs)("p",{children:["Welcome to your dashboard, ",e.name,"!"]}),Object(l.jsxs)("p",{children:["Email: ",e.email]}),Object(l.jsxs)("p",{children:["Role: ",e.role]}),Object(l.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),a("/login")},children:"Logout"})]})};var x=e=>{let{allowedRoles:t,user:a}=e;return a?t.includes(a.role)?Object(l.jsx)(n.b,{}):Object(l.jsx)(n.a,{to:"/unauthorized"}):Object(l.jsx)(n.a,{to:"/login"})};var v=function(){const[e,t]=Object(r.useState)(null);return Object(r.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(e){const a=await d.a.get("/api/user",{headers:{Authorization:e}});t(a.data)}}catch(e){console.error("Error fetching user data:",e)}})()}),[]),Object(l.jsxs)(n.e,{children:[Object(l.jsx)(n.c,{path:"/",element:Object(l.jsx)(i,{})}),Object(l.jsx)(n.c,{path:"/login",element:Object(l.jsx)(h,{})}),Object(l.jsx)(n.c,{path:"/register",element:Object(l.jsx)(m,{})}),Object(l.jsx)(n.c,{path:"/user-dashboard",element:Object(l.jsx)(x,{allowedRoles:["user","admin"],user:e,children:Object(l.jsx)(p,{})})}),Object(l.jsx)(n.c,{path:"/admin-dashboard",element:Object(l.jsx)(x,{allowedRoles:["admin"],user:e,children:Object(l.jsx)(g,{})})})]})};var f=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,45)).then((t=>{let{getCLS:a,getFID:r,getFCP:o,getLCP:s,getTTFB:c}=t;a(e),r(e),o(e),s(e),c(e)}))};s.a.render(Object(l.jsx)(c.a,{children:Object(l.jsx)(v,{})}),document.getElementById("root")),f()}},[[44,1,2]]]);
//# sourceMappingURL=main.dc7be50d.chunk.js.map